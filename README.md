# Проект распознавания текста на изображении №27

Этот проект демонстрирует распознавание текста на фотографии доски и интегрируется с Telegram и Zulip для отправки извлеченной информации.

## Спецификация

### Функционал

- **Распознавание текста на изображениях:** Извлекает текст из изображений с использованием различных моделей OCR (страница, многоколоночная страница, рукописный текст, таблицы).
- **Интеграция с Telegram:**
  - Отправляет распознанный текст указанным пользователям Telegram.
  - Позволяет прикреплять исходное изображение.
  - Хранит информацию о пользователях в локальной базе данных для упрощения взаимодействия.
- **Интеграция с Zulip:**
  - Отправляет распознанный текст указанным пользователям или потокам Zulip.
  - Позволяет указывать тему для сообщений в потоках.
  - Позволяет прикреплять исходное изображение.
- **Пакетная обработка:** Распознает текст из нескольких изображений в директории.
- **Периодическое сканирование:** Автоматически сканирует директорию на наличие новых изображений и обрабатывает их.

**В разработке:**
- Распознавание таблиц с загруженного фото.
- Отправка извлеченной информации на почту.
- Возможность гибкой и удобной настройки приложения.
- Интеграция с языковой моделью.

### Целевая аудитория:
- Преподаватели и лекторы, которые хотят делиться своими презентациями, лекциями и семинарами с аудиторией, коллегами или студентами других учебных заведений.
- Ученики и студенты, которые хотят сохранить информацию с доски в электронном виде, чтобы повторить материал, подготовиться к экзаменам или выполнить домашнее задание.
- Участники конференций, симпозиумов или воркшопов, которые хотят получить доступ к материалам, представленным на доске, или обсудить их с другими участниками.

### Какие юзкейсы могут быть у нашего сервиса?

- ***Учебная среда:***
Вы можете мгновенно получать и распространять лекционные или семинарские материалы с доски, не тратя время на записи и копирование.
- ***Конференции:***
Вы можете без труда запоминать и делиться ключевыми моментами выступлений, которые были представлены на доске. Просто сфотографируйте доску, и наше приложение преобразует все важные данные для анализа или обмена со слушателями.
- ***Деловые Встречи:***
Вы можете легко фиксировать и организовывать идеи, которые были вынесены на доску во время совещания. Сфотографируйте доску, и наше приложение создаст текстовый документ с этими идеями для последующего обсуждения.



## Технические характеристики
### Технические требования:
- Python 3.10+
- Docker и Docker Compose

### Требования к данным:
- Размер изображения не должен превышать 20 мегапикселей (длина × ширина).
- Формат файла .jpg, .png .jpeg и .pdf.
- Размер файла не должен превышать 20МБ.
- На водящих изображениях текст должен быть хорошо виден.

### Метрики качества:
- Точность распознавания результатов составяет 0.9412244558 (94%)
- Пользователь получил сообщение с извлеченно информацией на почту/в Telegram/Zulip.

## Требования для MVP
- Веб-интерфейс.
- Загрузка изображения для последующего его анализа.
- Извлечение текстовой(рукописной и печатной) информации с загруженного фото.  
- Отправка извлеченной информации в Telegram.
- Отправка извлеченной информации в Zulip.
- Автоматическое распознавание адреса электронной почты и ника в Telegram на загруженном фото для дальнейшей отправки.
- Анализ сразу нескольких файлов одновременно.
- Возможность автоматического сканирования директории с изображениями с указанной периодичностью.

## Требования для MUP
- Оптимизация использования API, занимаемой памяти и скорости сборки.
- Требования для MVP.
- Удобный веб-интерфейс с возможностью гибкой настройки приложения.  
- Отправка извлеченной информации на почту.
- Распознаваие таблиц.
- Интеграция с языковой моделью.

## Содержание репозитория
**Приложения:**
- `Start.py`, `pages/1_Manual_OCR.py`, `pages/2_Batch_processing`: Файлы основного приложения с веб-интерфейсом Streamlit.
- `bot.py`: Телеграм-бот для регистрации и управления пользователями.

**Модули:**
- `zulip_integration.py`: Функции для взаимодействия с API Zulip.
- `utilities.py`: Общие утилиты для обработки изображений, OCR и управления временными файлами.
- `telegram_integration.py`: Функции для взаимодействия с API Telegram Bot.

**Дополнительные файлы:**
- `run.sh`: Скрипт для запуска основного приложения.
- `requirements.txt`: Список необходимых библиотек Python.
- `docker-compose.yml`: Конфигурация Docker Compose для сборки и запуска сервиса.
- `README.md`: Общая документация по проекту.
- `Dockerfile`, `Dockerfile1`: Докерфайлы для сборки образов отдельных приложений.
- `.gitignore`, `.dockerignore`: Файлы для исключения из системы контроля версий и сборок Docker.
- `.env`: Шаблон файла окружения с необходимыми переменными конфигурации.

## Настройка

1. **Переменные окружения:** Заполните файл `.env` в директории `cfg` со следующими переменными:
    - `YC_OCR_ENDPOINT`: URL Yandex Cloud OCR API. См. [документацию Yandex Vision OCR](https://yandex.cloud/ru/docs/vision/ocr/api-ref/)
    - `YANDEX_API_KEY`: Ваш ключ API Yandex Cloud. См. [документацию Yandex Cloud](https://yandex.cloud/ru/docs/iam/concepts/authorization/api-key)
    - `TELEGRAM_BOT_TOKEN`: Ваш токен Telegram бота. См. [инструкция по получению Токена для Телеграм бота](https://www.cossa.ru/instahero/321374/)
    - `DATABASE_PATH`: Путь к файлу базы данных SQLite (необязательно, по умолчанию `db/users.db`).
    - `SCAN_PERIOD`: Временной интервал в секундах для периодического сканирования.
2. **Настройка Zulip:** Получите файл `zuliprc` и поместите его в директорию `cfg` с конфигурацией вашего бота Zulip. См. [документацию Zulip API](https://zulip.com/api/configuring-python-bindings#download-a-zuliprc-file) для получения подробной информации.

## Запуск приложения
1. Скопируйте репозиторий:\
`git clone https://git.miem.hse.ru/aimartinich/boardcv`
2. Произведите [настройку](#Настройка).
3. Выполните команду `docker compose up -d` для запуска приложения.
4. Перейдите адресу `http://localhost:8501` в браузере для открытия интерфейса.
